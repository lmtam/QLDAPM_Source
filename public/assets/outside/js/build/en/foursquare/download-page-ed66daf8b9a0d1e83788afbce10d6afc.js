fourSq.download.DownloadLinkView=function(a,b){};
fourSq.download.DownloadLinkView=fourSq.ui.View.extend({initialize:function(){var a=fourSq.api.models.companion.user.UserUtil.currentUser();this.phoneEmailInputView_=new fourSq.ui.PhoneEmailInput({countryCode:a&&a.location?a.location.countryCode:void 0,el:this.$el.find("input.phoneEmail").get(0)})},decorate:function(){if(fourSq.signup.sms().isHidden())return this.$el.empty(),this;this.$el.submit(fourSq.bind(this.onSubmit_,this));this.phoneEmailInputView_.decorate();this.phoneEmailInputView_.on(fourSq.ui.PhoneEmailInput.Events.INVALID_INPUT,
fourSq.bind(this.showValidationError_,this));this.phoneEmailInputView_.on(fourSq.ui.PhoneEmailInput.Events.VALID_INPUT,fourSq.bind(this.clearValidationError_,this));return this},onSubmit_:function(a){a.preventDefault();(a=this.phoneEmailInputView_.getIfValid())&&!this.$el.hasClass("sending")&&(this.$el.addClass("sending"),fourSq.api.services.PrivateWeb.sendDownloadEmail({email:a,source:fourSq.download.DownloadLinkView.SOURCE_ID},fourSq.bind(this.onSuccess_,this),fourSq.bind(this.onError_,this)))},
onSuccess_:function(){this.$el.removeClass("sending");this.$el.addClass("sent");this.$el.empty().append(helpers.download.getTheAppSuccess({}));fourSq.stats.log(fourSq.download.DownloadLinkView.SOURCE_ID).incr([fourSq.download.DownloadLinkView.SOURCE_ID,"text-sent"]).finish();fourSq.signup.sms().hide()},onError_:function(){this.$el.removeClass("sending");fourSq.ui.Notifier.getInstance().error(helpers.download.getTheAppError({}));fourSq.stats.log(fourSq.download.DownloadLinkView.SOURCE_ID).incr([fourSq.download.DownloadLinkView.SOURCE_ID,
"text-error"]).finish()},showValidationError_:function(a){this.$el.addClass("invalid");this.$el.find(".validationMessage").empty().append(a)},clearValidationError_:function(){this.$el.removeClass("invalid");this.$el.find(".validationMessage").empty()}},{SOURCE_ID:"downloadPage"});fourSq.views.DownloadPage=function(a,b){};
fourSq.views.DownloadPage=fourSq.views.Page.extend({initialize:function(a){fourSq.views.DownloadPage.__super__.initialize.call(this,a);this.$el.find(".downloadLink").click(this.handleDownloadLinkClick_)},handleDownloadLinkClick_:function(a){var b;switch($(a.currentTarget).prop("id")){case "iphoneDownloadLink":case "androidDownloadLink":case "windowsPhoneDownloadLink":b=fourSq.stats.action.Element.WINDOWS_PHONE}fourSq.isDefinedAndNotNull(b)&&(a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{element:fourSq.stats.action.Element.IPHONE}),
fourSq.stats.logActions(a))},pageViewName:function(){return fourSq.stats.action.View.DOWNLOAD}});